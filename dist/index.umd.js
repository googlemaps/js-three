!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("core-js/modules/es.array.iterator.js"),require("core-js/modules/es.object.to-string.js"),require("core-js/modules/es.typed-array.float32-array.js"),require("core-js/modules/es.typed-array.copy-within.js"),require("core-js/modules/es.typed-array.every.js"),require("core-js/modules/es.typed-array.fill.js"),require("core-js/modules/es.typed-array.filter.js"),require("core-js/modules/es.typed-array.find.js"),require("core-js/modules/es.typed-array.find-index.js"),require("core-js/modules/es.typed-array.for-each.js"),require("core-js/modules/es.typed-array.includes.js"),require("core-js/modules/es.typed-array.index-of.js"),require("core-js/modules/es.typed-array.iterator.js"),require("core-js/modules/es.typed-array.join.js"),require("core-js/modules/es.typed-array.last-index-of.js"),require("core-js/modules/es.typed-array.map.js"),require("core-js/modules/es.typed-array.reduce.js"),require("core-js/modules/es.typed-array.reduce-right.js"),require("core-js/modules/es.typed-array.reverse.js"),require("core-js/modules/es.typed-array.set.js"),require("core-js/modules/es.typed-array.slice.js"),require("core-js/modules/es.typed-array.some.js"),require("core-js/modules/es.typed-array.sort.js"),require("core-js/modules/es.typed-array.to-locale-string.js"),require("core-js/modules/es.typed-array.to-string.js"),require("core-js/modules/es.array.map.js"),require("core-js/modules/es.object.assign.js"),require("core-js/modules/web.url.to-json.js"),require("core-js/modules/es.math.sign.js"),require("three")):"function"==typeof define&&define.amd?define(["exports","core-js/modules/es.array.iterator.js","core-js/modules/es.object.to-string.js","core-js/modules/es.typed-array.float32-array.js","core-js/modules/es.typed-array.copy-within.js","core-js/modules/es.typed-array.every.js","core-js/modules/es.typed-array.fill.js","core-js/modules/es.typed-array.filter.js","core-js/modules/es.typed-array.find.js","core-js/modules/es.typed-array.find-index.js","core-js/modules/es.typed-array.for-each.js","core-js/modules/es.typed-array.includes.js","core-js/modules/es.typed-array.index-of.js","core-js/modules/es.typed-array.iterator.js","core-js/modules/es.typed-array.join.js","core-js/modules/es.typed-array.last-index-of.js","core-js/modules/es.typed-array.map.js","core-js/modules/es.typed-array.reduce.js","core-js/modules/es.typed-array.reduce-right.js","core-js/modules/es.typed-array.reverse.js","core-js/modules/es.typed-array.set.js","core-js/modules/es.typed-array.slice.js","core-js/modules/es.typed-array.some.js","core-js/modules/es.typed-array.sort.js","core-js/modules/es.typed-array.to-locale-string.js","core-js/modules/es.typed-array.to-string.js","core-js/modules/es.array.map.js","core-js/modules/es.object.assign.js","core-js/modules/web.url.to-json.js","core-js/modules/es.math.sign.js","three"],r):r(((e="undefined"!=typeof globalThis?globalThis:e||self).google=e.google||{},e.google.maps=e.google.maps||{},e.google.maps.plugins=e.google.maps.plugins||{},e.google.maps.plugins.three={}),null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,e.three)}(this,(function(e,r,s,t,o,a,n,l,i,u,d,y,c,j,h,p,m,f,v,g,b,q,w,x,R,M,T,E,k,S,L){"use strict";function C(e,r){for(var s=0;s<r.length;s++){var t=r[s];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}var A=function(){function e(r){var s=r.anchor,t=void 0===s?{lat:0,lng:0,altitude:0}:s,o=r.rotation,a=void 0===o?new Float32Array([0,0,0]):o,n=r.scale,l=void 0===n?new Float32Array([1,1,1]):n,i=r.scene,u=r.THREE,d=r.map;!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.overlay=new google.maps.WebGLOverlayView,this.renderer=null,this.camera=null,this.anchor=t,this.rotation=a,this.scale=l,this.THREE=u,this.scene=null!=i?i:new this.THREE.Scene,this.scene.rotation.x=Math.PI/2,this.overlay.onAdd=this.onAdd.bind(this),this.overlay.onRemove=this.onRemove.bind(this),this.overlay.onContextLost=this.onContextLost.bind(this),this.overlay.onContextRestored=this.onContextRestored.bind(this),this.overlay.onDraw=this.onDraw.bind(this),this.camera=new this.THREE.PerspectiveCamera,d&&this.setMap(d)}var r,s,t;return r=e,(s=[{key:"onStateUpdate",value:function(e){this.overlay.onStateUpdate(e)}},{key:"requestStateUpdate",value:function(){this.overlay.requestStateUpdate()}},{key:"onAdd",value:function(){}},{key:"onRemove",value:function(){}},{key:"getMap",value:function(){return this.overlay.getMap()}},{key:"requestRedraw",value:function(){this.overlay.requestRedraw()}},{key:"setMap",value:function(e){this.overlay.setMap(e)}},{key:"addListener",value:function(e,r){return this.overlay.addListener(e,r)}},{key:"bindTo",value:function(e,r,s,t){this.overlay.bindTo(e,r,s,t)}},{key:"get",value:function(e){return this.overlay.get(e)}},{key:"notify",value:function(e){this.overlay.notify(e)}},{key:"set",value:function(e,r){this.overlay.set(e,r)}},{key:"setValues",value:function(e){this.overlay.setValues(e)}},{key:"unbind",value:function(e){this.overlay.unbind(e)}},{key:"unbindAll",value:function(){this.overlay.unbindAll()}},{key:"onContextRestored",value:function(e){var r=e.gl;this.renderer=new this.THREE.WebGLRenderer(Object.assign({canvas:r.canvas,context:r},r.getContextAttributes())),this.renderer.autoClear=!1,this.renderer.autoClearDepth=!1,this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=this.THREE.PCFSoftShadowMap,this.renderer.outputEncoding=this.THREE.sRGBEncoding;var s=r.canvas,t=s.width,o=s.height;this.renderer.setViewport(0,0,t,o)}},{key:"onContextLost",value:function(){this.renderer&&(this.renderer.dispose(),this.renderer=null)}},{key:"onDraw",value:function(e){var r=e.gl,s=e.transformer;this.camera.projectionMatrix.fromArray(s.fromLatLngAltitude(this.anchor,this.rotation,this.scale)),r.disable(r.SCISSOR_TEST),this.requestRedraw(),this.renderer.render(this.scene,this.camera),this.renderer.resetState()}}])&&C(r.prototype,s),t&&C(r,t),e}(),V=6371010,H=Math.PI*V;function O(e){return e=function(e){return window.google&&google.maps&&e instanceof google.maps.LatLng?e.toJSON():e}(e),{x:V*L.MathUtils.degToRad(e.lng),y:0-V*Math.log(Math.tan(.5*(.5*Math.PI-L.MathUtils.degToRad(e.lat))))}}function P(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new L.Vector3,s=O(e),t=s.x,o=s.y;return r.set(t,0,-o)}e.EARTH_RADIUS=V,e.ThreeJSOverlayView=A,e.WORLD_SIZE=H,e.latLngToMeters=O,e.latLngToVector3=P,e.latLngToVector3Relative=function(e,r){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new L.Vector3,t=P(e),o=P(r);return s.setX(Math.abs(o.x-t.x)*Math.sign(t.x-o.x)),s.setY(Math.abs(o.y-t.y)*Math.sign(t.y-o.y)),s.setZ(Math.abs(o.z-t.z)*Math.sign(t.z-o.z)),s},Object.defineProperty(e,"__esModule",{value:!0})}));
